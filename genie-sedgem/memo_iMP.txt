Memo for iMP

A. OpenBLAS library is needed
    How to install (see also instruction at iMP repository in GitHub https://github.com/imuds/iMP):
        1. download: http://www.openblas.net/ -> TAR
        2. tar zxvf OpenBLAS-0.2.20.tar.gz
        3. cd OpenBLAS-0.2.20
        4. make BINARY=64 CC="gcc -m64" FC="gfortran -m64"
        5. su
        6. make PREFIX=/usr/local install

    If you get the error 'libopenblas.so.0: cannot open shared object file: No such file or directory' then try the following:
        1. sudo apt-get install libopenblas-base
        2. export LD_LIBRARY_PATH=/usr/lib/openblas-base/
    
B. Choose option 'kanzaki2019trs' for sg_par_sed_diagen_CaCO3opt in userconfig files.
    Currently you can also play around with fraction of aragonite 
        by changing the parameter 'sg_par_sed_kanzaki2019_arg' from 0 (calcite only) to 1 (aragonite only). 
        
More specifically:
to run the coupled model (i.e., cGENIE + iMP) for closed-system spin-up,

    1) Do usual closed system spin-up first (EXAMPLE.worbe2.RidgwellHargreaves1997_S36x36.SPIN1 for 20000 yr)
    2) Run the coupled closed system spin-up (EXAMPLE.worbe2.RH1997_S36x36_iMP_arg.SPIN1 for 1000 y)

E.g.,

    1) ./runmuffin_sed10yr.sh cgenie.eb_go_gs_ac_bg_sg_rg.worbe2.BASE / EXAMPLE.worbe2.RidgwellHargreaves1997_S36x36.SPIN1 20000
    2) ./runmuffin_sed10yr.sh cgenie.eb_go_gs_ac_bg_sg_rg.worbe2.BASE / EXAMPLE.worbe2.RH1997_S36x36_iMP_arg.SPIN1 1000 EXAMPLE.worbe2.RidgwellHargreaves1997_S36x36.SPIN1

*** Note that iMP tries to reach steady state when called for the first time 
(takes a huge time step, 10^8 yr only called for the first time; 
after that takes the time step for sediment model, i.e., 10 yr in the above example)
so 1000 yr is not necessary for spin-up for closed system with iMP 
(you can see no difference between 10 yr result and 1000 yr results in iMP). ***

*** Also note that iMP is much slower than sedgem so run only once 10 year 
which is realized using 'runmuffin_sed10yr.sh' instead of 'runmuffin.sh' ***

*** Final note: display should show a lot of warnings while running but just ignore these for now ***

iMP provides CaCO3 dissolution flux and change in this flux is reflected in all output as in usual cGENIE simulations.

Sediment profiles calculated by iMP is stored in sedgem/imp/profiles directory.
Global maps of sediment composition are stored in sedgem/imp directory.
I have not stored these output in netCDF but currently in text data.

Those files are:
ccbml-xxx (CaCO3 composition in wt% at the bottom of mixed layer)
ccdis-xxx (CaCO3 dissolution flux)
ccsfc-xxx (CaCO3 comp. at the seawater-sediment interface)
ccsfcave-xxx (CaCO3 average comp. within mixed layer)
errf-xxx (relative error in total volume of solid sediment, used as an indicator of overall covergence)
om-xxx (OM comp. in wt% at the bottom of mixed layer)
pt-xxx (Detrital material comp. in wt% at the bottom of mixed layer)

xxx includes information regarding CaCO3 species and time of recording:
currently sp001 means calcite species while sp002 means aragonite.
Other number (e.g., 100) means time in yr but divided by 10 (e.g., 100 means 1000 yr) (I do not remember why I did this...).

